<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="generator" content="pandoc" />
  <meta name="author" content="TANG ZhiXiong; dvorak4tzx; district10" />
  <meta name="date" content="2015-11-30" />
  <title>&#29992; CvANN_MLP &#36827;&#34892;&#36335;&#29260;&#21028;&#21035;</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
  <link rel="stylesheet" href="jquery-ui.css" type="text/css" />
  <link rel="stylesheet" href="font-awesome.min.css" type="text/css" />
  <link rel="stylesheet" href="main.css" type="text/css" />
</head>
<body>
<div id="header">
<h1 class="title">&#29992; CvANN_MLP &#36827;&#34892;&#36335;&#29260;&#21028;&#21035;</h1>
<h3 class="date">2015-11-30</h3>
</div>
<div id="tocbox" class="pokerface">
    <div id="tocboxheader">&#xf03b;</div>
    <div id="tocboxbody">
        <ul>
        <li><a href="#&#29992;-cvann_mlp-&#36827;&#34892;&#36335;&#29260;&#21028;&#21035;">&#29992; CvANN_MLP &#36827;&#34892;&#36335;&#29260;&#21028;&#21035;</a><ul>
        <li><a href="#&#24555;&#36895;&#20837;&#38376;">&#24555;&#36895;&#20837;&#38376;</a></li>
        <li><a href="#&#26356;&#36827;&#19968;&#27493;">&#26356;&#36827;&#19968;&#27493;</a><ul>
        <li><a href="#&#28304;&#25968;&#25454;&#30340;&#22788;&#29702;">&#28304;&#25968;&#25454;&#30340;&#22788;&#29702;</a></li>
        </ul></li>
        </ul></li>
        </ul>
    </div>
</div>
<div id="navigator" class="pokerface"><a id="gotoindex" href="index.html" title="&#25353;&#19979;&#12304;h&#12305;&#33719;&#21462;&#39029;&#38754;&#24110;&#21161;&#12290;">&#xf015;</a></div>
<h1 id="&#29992;-cvann_mlp-&#36827;&#34892;&#36335;&#29260;&#21028;&#21035;">&#29992; CvANN_MLP &#36827;&#34892;&#36335;&#29260;&#21028;&#21035;</h1>
<blockquote>
<p>&#36825;&#21407;&#26159;&#26234;&#33021;&#35745;&#31639;&#35838;&#31243;&#22823;&#20316;&#19994;&#12290;</p>
</blockquote>
<p>&#65288;&#26377;&#26102;&#20505;&#25105;&#30495;&#30340;&#19981;&#30693;&#36947;&#24590;&#20040;&#25514;&#36766;&#65292;&#24212;&#35813;&#29992;&#8220;&#20998;&#31867;&#35782;&#21035;&#8221;&#65292;&#36824;&#26159;&#8220;&#21028;&#21035;&#8221;&#65292;&#36824;&#26159;&#8220;&#26029;&#21035;&#8221;&#65311;&#19981;&#22312;&#24847;&#36825;&#20123;&#32454;&#33410;&#12290;&#25105;&#35828;&#30340;&#26159;&#21306;&#20998;&#19968;&#24352;&#22270;&#29255;&#26159;&#19981;&#26159;&#36335;&#29260;&#65292;&#23601;&#36825;&#20040;&#31616;&#21333;&#12290;&#65289;</p>
<p>&#20351;&#29992; ANN-MLP&#65288;&#31070;&#32463;&#32593;&#32476;&#8211;&#22810;&#23618;&#24863;&#30693;&#22120;&#65289;&#26041;&#27861;&#12290;&#21033;&#29992; Qt4&#12289;OpenCV2 &#31243;&#24207;&#24211;&#65292;&#36827;&#34892;&#36335;&#29260;&#30340;&#25248;&#21462;&#12289;&#20998;&#31867;&#21644;&#35782;&#21035;&#12290;&#24320;&#28304;&#22312; GitHub&#65306;<a href="https://github.com/district10/SignProcessing">district10/SignProcessing: &#36335;&#29260;&#25552;&#21462;&#12289;&#20998;&#31867;</a>&#65292;&#21253;&#25324;&#28304;&#30721;&#12289;&#25991;&#26723;&#12289;&#27979;&#35797;&#25968;&#25454;&#21644;&#21487;&#25191;&#34892;&#25991;&#20214;&#12290;&#20854;&#20013;&#30340; <a href="https://github.com/district10/SignProcessing/tree/qt4cv3vs2015">qt4cv3vs2015</a> &#20998;&#25903;&#23558; OpenCV &#26356;&#26032;&#21040;&#20102; OpenCV3&#65292;&#37325;&#26032;&#26803;&#29702;&#12289;&#25972;&#21512;&#20102;&#21508;&#20010;&#27169;&#22359;&#12290;</p>
<h2 id="&#24555;&#36895;&#20837;&#38376;">&#24555;&#36895;&#20837;&#38376;</h2>
<p>&#25991;&#26723;&#36148;&#22312;&#36825;&#37324;&#65292;&#21407;&#36733; <a href="https://github.com/district10/SignProcessing/issues">Issues &#183; district10/SignProcessing</a>&#12290;</p>
<dl>
<dt>&#19979;&#36733;&#20108;&#36827;&#21046;</dt>
<dd><p><strong>DLL &#20381;&#36182;</strong></p>
<p>Qt &#21644; OpenCV &#30340; dll&#65292;&#20197;&#21450; VS2015 &#30340; runtime&#65292;<a href="http://whudoc.qiniudn.com/2016/sp-dlls.7z">&#28857;&#27492;&#19979;&#36733;</a> &#65288;11.2 MB&#65289;&#65292;&#21644;&#19979;&#38754;&#30340;&#20108;&#36827;&#21046;&#25191;&#34892;&#26723;&#25918;&#21040;&#19968;&#36215;&#21363;&#21487;&#12290;</p>
<p><strong>&#20108;&#36827;&#21046;&#25191;&#34892;&#26723;</strong></p>
<ul>
<li><a href="http://whudoc.qiniudn.com/2016/SignProcessing_Release-2.7z">Release 2, 2016-07-31</a>, 962 KB</li>
<li><a href="http://whudoc.qiniudn.com/2016/SignProcessing_Release-1.7z">Release 1, 2016-07-30</a>, 478 KB</li>
</ul>
<hr />
<p>&#21018;&#25165; fix &#20102;&#20960;&#20010;&#38169;&#35823;&#65292;&#29616;&#22312;&#22312; Ubuntu &#20063;&#36305;&#36215;&#26469;&#20102;</p>
<p><strong>Linux <code>.so</code> files</strong></p>
<p><a href="http://whudoc.qiniudn.com/2016/sp-sos.tar.xz"><code>.so</code> &#25991;&#20214;</a> (10.1 MB)</p>
<pre><code>$ ls -alh
total 44M
drwxrwxr-x 2 tzx tzx 4.0K  8&#26376;  1 20:54 .
drwxrwxr-x 3 tzx tzx 4.0K  8&#26376;  1 21:00 ..
-rw-r--r-- 1 tzx tzx  13M  8&#26376;  1 20:53 libopencv_core.so.3.0.0
-rw-r--r-- 1 tzx tzx 2.0M  8&#26376;  1 20:53 libopencv_imgcodecs.so.3.0.0
-rw-r--r-- 1 tzx tzx  15M  8&#26376;  1 20:53 libopencv_imgproc.so.3.0.0
-rw-r--r-- 1 tzx tzx 870K  8&#26376;  1 20:53 libopencv_ml.so.3.0.0
-rw-r--r-- 1 tzx tzx 3.0M  8&#26376;  1 20:54 libQtCore.so.4
-rw-r--r-- 1 tzx tzx  11M  8&#26376;  1 20:54 libQtGui.so.4</code></pre>
<p><strong>Linux binaries</strong></p>
<ul>
<li><a href="http://whudoc.qiniudn.com/2016/SignProcessing_Release_linux-1.tar.xz">Release 1, 2016-08-01</a> 869 KB</li>
</ul>
</dd>
<dt>&#22914;&#20309;&#29992;&#24050;&#35757;&#32451;&#27169;&#22411;&#26469;&#27979;&#35797;&#22270;&#29255;&#26159;&#21542;&#26159;&#36335;&#29260;</dt>
<dd><p><strong>SignProcessorDemo.exe</strong></p>
<p>&#36825;&#20010; exe &#26377;&#19977;&#20010;&#21151;&#33021;&#65292;&#20027;&#35201;&#26159;&#29992;&#24050;&#32463;&#35757;&#32451;&#22909;&#30340;&#27169;&#22411;&#26469;&#39044;&#27979;&#65288;predict&#65289;&#12290;</p>
<p><strong>&#21151;&#33021; 1&#65292;&#21028;&#21035;&#21333;&#24352;&#22270;&#29255;</strong></p>
<p>&#21152;&#36733;&#19968;&#20010;&#22270;&#29255;&#65292;&#22914;&#26524;&#21028;&#23450;&#26159;&#19968;&#20010;&#36335;&#29260;&#65292;&#29992;&#28129;&#34013;&#33394;&#26174;&#31034;&#8220;Sign (pos)&#8221;&#65306;</p>
<div class="figure">
<img src="http://whudoc.qiniudn.com/2016/SignProcessorDemo_2016-07-31_16-18-06.png" />

</div>
<p>&#22914;&#26524;&#19981;&#26159;&#19968;&#20010;&#36335;&#29260;&#65292;&#29992;&#32418;&#33394;&#26174;&#31034;&#8220;Not Sign (neg)&#8221;&#65306;</p>
<div class="figure">
<img src="http://whudoc.qiniudn.com/2016/SignProcessorDemo_2016-07-31_16-25-23.png" />

</div>
<p><strong>&#21151;&#33021; 2&#65292;&#21028;&#21035;&#25991;&#20214;&#22841;&#19979;&#25152;&#26377;&#22270;&#29255;</strong></p>
<p>&#25209;&#37327;&#21028;&#26029;&#12290;&#36873;&#25321;&#19968;&#20010;&#25991;&#20214;&#22841;&#65288;&#36825;&#37324;&#26159; <code>dir_of_images</code>&#65289;&#12290;</p>
<div class="figure">
<img src="http://whudoc.qiniudn.com/2016/2016-07-31_16-20-34.png" />

</div>
<p>&#21028;&#26029;&#32467;&#26524;&#36755;&#20986;&#22312;&#25991;&#26412;&#26694;&#20869;&#65292;&#21253;&#25324;&#22270;&#29255;&#25968;&#30446;&#12289;&#27599;&#24352;&#22270;&#29255;&#30340;&#36335;&#24452;&#20197;&#21450;&#21028;&#21035;&#32467;&#26524;&#65306;</p>
<pre><code>To Predict 38 images.


    processing D:/tzx/git/SignProcessing/data/input/dir_of_images/0002-team7 (109)-shift-sx-36-sy-16.bmp... done. assigned to [pos]
    ...
    processing D:/tzx/git/SignProcessing/data/input/dir_of_images/dir2/dir22/0001-team7 (108)-rand-cx0623-cy0398-r135.bmp... done. assigned to [neg]</code></pre>
<p>&#25152;&#36873;&#25991;&#20214;&#22841;&#21516;&#19968;&#30446;&#24405;&#19979;&#36824;&#20250;&#20986;&#29616;&#20004;&#20010;&#30446;&#24405; <code>pos</code> &#21644; <code>neg</code>&#65292;&#20998;&#21035;&#25226;&#21028;&#21035;&#21518;&#30340;&#22270;&#29255;&#25335;&#36125;&#21040;&#37324;&#37324;&#38754;&#65306;</p>
<div class="figure">
<img src="http://whudoc.qiniudn.com/2016/explorer_2016-07-31_16-23-28.png" />

</div>
<div class="figure">
<img src="http://whudoc.qiniudn.com/2016/explorer_2016-07-31_16-23-13.png" />

</div>
<p><strong>&#21151;&#33021; 3&#65292;&#21028;&#21035;&#36873;&#25321;&#30340;&#22810;&#24352;&#22270;&#29255;</strong></p>
<div class="figure">
<img src="http://whudoc.qiniudn.com/2016/SignProcessorDemo_2016-07-31_16-21-58.png" />

</div>
<p>&#21028;&#21035;&#20026;&#36335;&#29260;&#30340;&#65292;&#26631;&#35760;&#8220;Pos&#8221;&#65292;&#19981;&#26159;&#36335;&#29260;&#30340;&#65292;&#26631;&#35760;&#8220;Neg&#8221;&#12290;</p>
<p><strong>&#40664;&#35748;&#29992;&#20102; <a href="https://github.com/district10/SignProcessing/blob/qt4cv3vs2015/data/output/4.xml"><code>data/output/4.xml</code></a> &#26469;&#39044;&#27979;&#65292;&#20320;&#20063;&#21487;&#20197;&#28857;&#20987;&#12304;Load Another XML&#12305;&#21152;&#36733;&#21035;&#30340;&#24050;&#35757;&#32451;&#27169;&#22411;&#12290;</strong></p>
<hr />
<p><strong>1&#65289;&#21452;&#20987;&#36816;&#34892; SignClassifierDemo.exe</strong></p>
<div class="figure">
<img src="http://whudoc.qiniudn.com/2016/2016-07-30_03-34-16.png" />

</div>
<p><strong>2&#65289;&#21152;&#36733;&#27169;&#22411;</strong></p>
<p>&#28857;&#20987;&#12304;Load Trained&#12305;&#36873;&#25321; XML &#25991;&#20214;&#65288;&#22312; <code>data/output</code> &#25991;&#20214;&#22841;&#65289;&#12290;&#25105;&#36825;&#37324;&#36873;&#25321;&#20102; <code>4.xml</code>&#12290;</p>
<p><strong>3&#65289;&#36873;&#25321;&#24819;&#35201;&#27979;&#35797;&#30340;&#22270;&#29255;</strong></p>
<p>&#28857;&#20987;&#12304;Unknown&#12305;&#65292;&#36873;&#25321;&#19968;&#20123;&#22270;&#29255;&#65288;&#22312; <code>data/input/tests</code> &#25991;&#20214;&#22841;&#65289;&#12290;</p>
<p>&#22914;&#19979;&#22270;&#65292;</p>
<div class="figure">
<img src="http://whudoc.qiniudn.com/2016/2016-07-30_08-50-08.png" />

</div>
<p>&#36824;&#27809;&#26377;&#39044;&#27979;&#30340;&#22270;&#29255;&#19979;&#38754;&#26377;&#8220;???&#8221;&#26631;&#35760;&#65292;&#23427;&#34920;&#31034;&#36824;&#26410;&#27979;&#35797;&#12290;</p>
<p>&#28982;&#21518;&#28857;&#20987;&#12304;Predict&#12305;&#12290;</p>
<p>&#26377;&#30340;&#26631;&#35760;&#21464;&#25104;&#20102;&#8220;Pos&#8221;&#65288;&#26159;&#36335;&#29260;&#65289;&#65292;&#26377;&#24471;&#26631;&#35760;&#21464;&#25104;&#20102;&#8220;Neg&#8221;&#65288;&#19981;&#26159;&#36335;&#29260;&#65289;&#65292;&#22914;&#19979;&#22270;&#65306;</p>
<div class="figure">
<img src="http://whudoc.qiniudn.com/2016/SignClassifierDemo_2016-07-30_08-51-00.png" />

</div>
</dd>
<dt>&#22914;&#20309;&#20174;&#25968;&#25454;&#35757;&#32451;&#27169;&#22411;</dt>
<dd><p><strong>1&#65289;&#21452;&#20987;&#36816;&#34892; SignClassifierDemo.exe</strong></p>
<p><strong>2&#65289;&#28155;&#21152;&#27491;&#36127;&#26679;&#26412;</strong></p>
<p>&#28857;&#20987;&#12304;Pos&#12305;&#65292;&#36873;&#25321;&#19968;&#20123;&#27491;&#26679;&#26412;&#12290;&#65288;&#21487;&#29992; <kbd>Control+A</kbd> &#20840;&#36873;&#65289;</p>
<p>&#21516;&#29702;&#65292;&#28857;&#20987;&#12304;Neg&#12305;&#65292;&#36873;&#25321;&#19968;&#20123;&#36127;&#26679;&#26412;&#12290;&#65288;&#21152;&#36733;&#21487;&#33021;&#26377;&#28857;&#24930;&#65289;</p>
<p><strong>3&#65289;&#35757;&#32451;</strong></p>
<p>&#28857;&#20987;&#12304;Train&#12305;&#65292;&#35757;&#32451;&#24320;&#22987;&#12290;&#35757;&#32451;&#23436;&#25104;&#21518;&#65292;&#20250;&#25552;&#31034;&#24050;&#32463;&#35757;&#32451;&#30340;&#37327;&#12290;</p>
<p>&#35760;&#24471;&#28857;&#20987;&#12304;Save Trained&#12305;&#20445;&#23384;&#35757;&#32451;&#21442;&#25968;&#65292;&#19979;&#27425;&#23601;&#21487;&#20197;&#30452;&#25509;&#29992;&#12304;Load Trained&#12305;&#21152;&#36733;&#23427;&#20102;&#12290;</p>
<p>&#35797;&#35797;&#21152;&#36733;&#19968;&#20123; Unknown&#65292;&#27979;&#35797;&#19968;&#19979;&#23427;&#30340;&#21028;&#26029;&#26159;&#21542;&#27491;&#30830;&#12290;</p>
<hr />
<p>&#23601;&#26159;&#36825;&#26679;&#12290;</p>
</dd>
<dt>&#20174;&#28304;&#30721;&#32534;&#35793;</dt>
<dd><ul>
<li>&#23433;&#35013; VS2015 &#31038;&#21306;&#29256;</li>
<li>&#37197;&#32622; Qt4 &#21644; OpenCV3</li>
<li>&#19979;&#36733;&#28304;&#30721;&#65306;<a href="https://github.com/district10/SignProcessing/archive/qt4cv3vs2015.zip">&#12304;qt4cv3vs2015 &#20998;&#25903;&#28304;&#30721;&#21387;&#32553;&#21253;&#12305;</a></li>
</ul>
<p>&#20855;&#20307;&#35265; <a href="https://github.com/district10/SignProcessing/issues/3">&#20195;&#30721;&#32534;&#35793; &#183; Issue #3 &#183; district10/SignProcessing</a>&#12290;</p>
</dd>
</dl>
<h2 id="&#26356;&#36827;&#19968;&#27493;">&#26356;&#36827;&#19968;&#27493;</h2>
<p>&#21487;&#20197;&#30475;&#21040;&#65292;&#30475;&#21040;&#31243;&#24207;&#33021;&#22522;&#26412;&#20934;&#30830;&#22320;&#20998;&#36776;&#21738;&#20123;&#26159;&#36335;&#29260;&#65292;&#21738;&#20123;&#19981;&#26159;&#12290;&#29616;&#22312;&#25105;&#20174;&#25968;&#25454;&#37319;&#38598;&#12289;&#22788;&#29702;&#65292;&#31243;&#24207;&#32534;&#20889;&#26469;&#25226;&#25972;&#20010;&#27969;&#31243;&#35828;&#19968;&#36941;&#12290;</p>
<h3 id="&#28304;&#25968;&#25454;&#30340;&#22788;&#29702;">&#28304;&#25968;&#25454;&#30340;&#22788;&#29702;</h3>
<p>&#28304;&#25968;&#25454;&#26159;&#25105;&#20204;&#22312;&#27494;&#27721;&#34903;&#22836;&#25293;&#25668;&#30340;&#36335;&#29260;&#22270;&#29255;&#12290;&#22823;&#27010;&#20687;&#36825;&#26679;&#65306;</p>
<div class="figure">
<img src="http://whudoc.qiniudn.com/2016/sp-rawinput.jpg" />

</div>
<p>&#22240;&#20026;&#28304;&#22270;&#29255;&#37324;&#38754;&#26377;&#36710;&#29260;&#20043;&#31867;&#30340;&#27809;&#26377;&#25171;&#30721;&#65288;&#21738;&#26377;&#36825;&#31354;&#21834;&#8230;&#8230;&#65289;&#65292;&#23601;&#19981;&#20998;&#20139;&#20102;&#12290;</p>
<p>&#20174;&#28304;&#22270;&#29255;&#20013;&#25552;&#21462;&#27491;&#36127;&#26679;&#26412;&#65292;&#29992;&#30340;&#26159;&#25105;&#20204;&#32452;&#20889;&#30340; Sign Cutter&#65288;&#36335;&#29260;&#20999;&#21106;&#65289;&#31243;&#24207;&#65288;<a href="https://github.com/district10/SignProcessing/tree/qt4cv3vs2015/src/SignCutter">&#28304;&#30721;</a>&#65289;&#65292;</p>
<div class="figure">
<img src="http://whudoc.qiniudn.com/2016/annlau-ppt.png" alt="Sign Cutter" />
<p class="caption">Sign Cutter</p>
</div>
<p>&#21033;&#29992;&#23427;&#21487;&#20197;&#24456;&#24555;&#36895;&#22320;&#23548;&#20837;&#28304;&#24433;&#20687;&#65292;&#24182;&#36827;&#34892;&#20999;&#29255;&#22788;&#29702;&#12290;&#12304;&#20445;&#23384;&#20999;&#29255;&#12305;&#25805;&#20316;&#20250;&#25226;&#26694;&#36873;&#21306;&#22495;&#20445;&#23384;&#25104;&#19968;&#20010;&#20999;&#29255;&#22270;&#65292;&#20316;&#20026;&#25105;&#20204;&#20154;&#24037;&#36873;&#21462;&#30340;&#27491;&#26679;&#26412;&#12290;&#21516;&#26102;&#65292;&#27491;&#26679;&#26412;&#38656;&#35201;&#36716;&#21270;&#21040; 24 &#215; 24 &#30340; RGB &#22270;&#20687;&#65292;&#20026;&#20445;&#35777;&#22270;&#29255;&#19981;&#22833;&#30495;&#65292;&#36824;&#35201;&#23558;&#20043;&#23384;&#20648;&#20026; BMP &#26684;&#24335;&#12290;</p>
<div class="figure">
<img src="http://gnat.qiniudn.com/signcutter/cut.jpg" alt="&#27491;&#26679;&#26412;&#20026;&#20154;&#24037;&#36873;&#21462;&#30340;&#36335;&#29260;" />
<p class="caption">&#27491;&#26679;&#26412;&#20026;&#20154;&#24037;&#36873;&#21462;&#30340;&#36335;&#29260;</p>
</div>
<p>&#22240;&#20026;&#27491;&#26679;&#26412;&#30340;&#25968;&#37327;&#26377;&#38480;&#65292;&#38656;&#35201;&#36890;&#36807;&#24179;&#31227;&#12289;&#26059;&#36716;&#12289;&#38236;&#20687;&#65288;&#38236;&#20687;&#21518;&#20877;&#24179;&#31227;&#26059;&#36716;&#65289;&#31561;&#26041;&#24335;&#20174;&#19968;&#24352;&#27491;&#26679;&#26412;&#20135;&#29983;&#22810;&#24352;&#31867;&#20284;&#27491;&#26679;&#26412;&#12290;&#22312; SignCutter &#20013;&#36890;&#36807;&#28857;&#20987;&#12304;&#29983;&#25104;&#27491;&#26679;&#26412;&#12305;&#23454;&#29616;&#12290;</p>
<div class="figure">
<img src="http://gnat.qiniudn.com/signcutter/pos_neg_click.jpg" />

</div>
<p>&#36127;&#26679;&#26412;&#21017;&#26159;&#20174;&#22270;&#20013;&#38750;&#27491;&#26679;&#26412;&#21306;&#22495;&#65292;&#38543;&#26426;&#36873;&#21462;&#20013;&#24515;&#28857;&#21644;&#26059;&#36716;&#35282;&#24230;&#65292;&#36873;&#21462;&#32780;&#26469;&#12290;&#27491;&#36127;&#26679;&#26412;&#36873;&#21462;&#27604;&#20363;&#25105;&#20204;&#35774;&#32622;&#20026; 1:7&#12290;&#36890;&#36807;&#28857;&#20987;&#12304;&#29983;&#25104;&#36127;&#26679;&#26412;&#12305;&#26469;&#24555;&#36895;&#22320;&#29983;&#25104;&#19968;&#31995;&#21015;&#36127;&#26679;&#26412;&#12290;&#32467;&#26524;&#23601;&#26159;&#65292;&#19968;&#24352;&#28304;&#22270;&#29255;&#65292;&#19968;&#20010;&#20154;&#24037;&#26694;&#36873;&#21306;&#22495;&#65292;&#29983;&#25104;&#20102; 87 &#24352;&#27491;&#26679;&#26412;&#65292;602 &#24352;&#36127;&#26679;&#26412;&#12290;&#26368;&#32456;&#25105;&#20204;&#29983;&#25104;&#20102; 8 &#32452;&#20849; 25,230 &#24352;&#27491;&#26679;&#26412;&#65292;69,894 &#24352;&#36127;&#26679;&#26412;&#65292;&#29992;&#20110;&#35757;&#32451;&#21644;&#26816;&#27979;&#12290;</p>
<p>&#20320;&#21487;&#20197;&#19979;&#36733; <a href="http://whudoc.qiniudn.com/2016/sp-all.csv">&#22270;&#29255;&#32034;&#24341;</a>&#65292;&#27599;&#19968;&#34892;&#20195;&#34920;&#19968;&#20010;&#26679;&#26412;&#65292;&#21518;&#38754;&#30340; 1 &#34920;&#31034;&#8220;&#26159;&#36335;&#29260;&#8221;&#65292;0 &#34920;&#31034;&#8220;&#19981;&#26159;&#36335;&#29260;&#8221;&#65292;&#22823;&#27010;&#38271;&#36825;&#26679;&#65306;</p>
<pre><code>1/pos/0001-team7 (1)-___.bmp, 1
1/pos/0001-team7 (1)-___-r000.bmp, 1
1/pos/0001-team7 (1)-___-r030.bmp, 1
...
8/neg/0025-team7 (292)-rand-cx0469-cy2820-r108.bmp, 0
8/neg/0025-team7 (292)-rand-cx0471-cy2508-r232.bmp, 0
8/neg/0025-team7 (292)-rand-cx0473-cy2701-r358.bmp, 0</code></pre>
<p>&#22270;&#29255;&#25968;&#25454;&#22312;&#36825;&#37324;&#19979;&#36733;&#65306;</p>
<ul>
<li><a href="http://gnat.qiniudn.com/sczip/1.7z">1.7z</a> 8.9M</li>
<li><a href="http://gnat.qiniudn.com/sczip/2.7z">2.7z</a> 10M</li>
<li><a href="http://gnat.qiniudn.com/sczip/3.7z">3.7z</a> 13M</li>
<li><a href="http://gnat.qiniudn.com/sczip/4.7z">4.7z</a> 24M</li>
<li><a href="http://gnat.qiniudn.com/sczip/5.7z">5.7z</a> 13M</li>
<li><a href="http://gnat.qiniudn.com/sczip/6.7z">6.7z</a> 10M</li>
<li><a href="http://gnat.qiniudn.com/sczip/7.7z">7.7z</a> 8.5M</li>
<li><a href="http://gnat.qiniudn.com/sczip/8.7z">8.7z</a> 3.1M</li>
</ul>
<div class="figure">
<img src="http://gnat.qiniudn.com/signcutter/pos_neg.jpg" alt="&#27491;&#26679;&#26412; 87 &#24352; &amp; &#36127;&#26679;&#26412; 602 &#24352;" />
<p class="caption">&#27491;&#26679;&#26412; 87 &#24352; &amp; &#36127;&#26679;&#26412; 602 &#24352;</p>
</div>
<p>&#20026;&#20102;&#20445;&#35777;&#24471;&#21040;&#30340;&#27491;&#26679;&#26412;&#36275;&#22815;&#22909;&#65292;&#25105;&#20204;&#19981;&#26159;&#22312;&#20999;&#29255;&#19978;&#36827;&#34892;&#36825;&#20123;&#25805;&#20316;&#65292;&#32780;&#26159;&#22312;&#28304;&#24433;&#20687;&#19978;&#65292;&#36825;&#23601;&#36991;&#20813;&#20102;&#26059;&#36716;&#24179;&#31227;&#21518;&#22270;&#29255;&#20013;&#23384;&#22312;&#31354;&#30333;&#12290;&#36825;&#36890;&#36807;&#19968;&#20010; SignLogger &#27169;&#22359;&#23454;&#29616;&#65288;<a href="https://github.com/district10/SignProcessing/tree/qt4cv3vs2015/src/SignLogger">&#28304;&#30721;</a>&#65289;&#65292;&#23427;&#35760;&#24405;&#20102;&#20999;&#29255;&#30340;&#28304;&#22270;&#29255;&#12289;&#24402;&#19968;&#21270;&#20102;&#30340;&#20013;&#24515;&#28857;&#12289;&#24402;&#19968;&#21270;&#20102;&#30340;&#23485;&#24230;&#21644;&#39640;&#24230;&#12290;</p>
<div class="figure">
<img src="http://gnat.qiniudn.com/signcutter/cutted_out_info.jpg" alt="&#36890;&#36807;&#28857;&#20987;&#12304;&#26597;&#30475;&#20999;&#29255;&#35760;&#24405;&#12305;&#26597;&#30475;&#20999;&#29255;&#20449;&#24687;" />
<p class="caption">&#36890;&#36807;&#28857;&#20987;&#12304;&#26597;&#30475;&#20999;&#29255;&#35760;&#24405;&#12305;&#26597;&#30475;&#20999;&#29255;&#20449;&#24687;</p>
</div>
<div class="figure">
<img src="http://gnat.qiniudn.com/signcutter/pos_info.jpg" alt="&#36825;&#23601;&#26159;&#21018;&#25165;&#37027;&#24352;&#36335;&#29260;&#20999;&#29255;&#30340; log &#20449;&#24687;" />
<p class="caption">&#36825;&#23601;&#26159;&#21018;&#25165;&#37027;&#24352;&#36335;&#29260;&#20999;&#29255;&#30340; log &#20449;&#24687;</p>
</div>
<p>&#25972;&#20010;&#27491;&#26679;&#26412;&#21644;&#36127;&#26679;&#26412;&#22914;&#22270;&#65292;&#32418;&#26694;&#20869;&#20026;&#20999;&#29255;&#21306;&#22495;&#65292;&#32511;&#33394;&#30697;&#24418;&#20026;&#27491;&#26679;&#26412;&#26694;&#65288;&#36739;&#23494;&#38598;&#65289;&#65292;&#34013;&#33394;&#20026;&#36127;&#26679;&#26412;&#26694;&#65288;&#20998;&#25955;&#22312;&#28304;&#24433;&#20687;&#20013;&#38750;&#27491;&#26679;&#26412;&#21306;&#22495;&#65289;&#12290;</p>
<div class="figure">
<img src="http://gnat.qiniudn.com/signcutter/sign_cut_demo.jpg" />

</div>
<p>&#20174;&#25991;&#20214;&#21517;&#20063;&#33021;&#30475;&#20986;&#27599;&#20010;&#20999;&#29255;&#30340;&#20449;&#24687;&#65292;&#36825;&#37324;&#26159;&#27491;&#36127;&#26679;&#26412;&#25991;&#20214;&#21517;&#30340; Sample<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a></p>
<pre class="tree"><code>&#21407;&#22270;&#29255; team7 (148).jpg &#20135;&#29983;&#30340;&#27491;&#36127;&#26679;&#26412;

.
&#9500;&#9472;&#9472; pos                            &#65288;&#27491;&#26679;&#26412; 87 &#24352;&#65289;
&#9474;&#160;&#160; &#9500;&#9472;&#9472; 0041-team7 (148)-___.bmp                 &#21407;&#20999;&#29255;
&#9474;&#160;&#160; &#9500;&#9472;&#9472; 0041-team7 (148)-___-r030.bmp            &#21407;&#20999;&#29255;&#26059;&#36716; 30 &#24230;
&#9474;&#160;&#160; &#9500;&#9472;&#9472;..............................
&#9474;&#160;&#160; &#9500;&#9472;&#9472; 0041-team7 (148)-___-r330.bmp
&#9474;&#160;&#160; &#9500;&#9472;&#9472; 0041-team7 (148)-L-R.bmp                 &#24038;&#21491;&#38236;&#20687;
&#9474;&#160;&#160; &#9500;&#9472;&#9472; 0041-team7 (148)-L-R-r030.bmp            &#24038;&#21491;&#38236;&#20687;&#21518;&#65292;&#26059;&#36716; 30 &#24230;
&#9474;&#160;&#160; &#9500;&#9472;&#9472; 0041-team7 (148)-L-R-r060.bmp
&#9474;&#160;&#160; &#9500;&#9472;&#9472; 0041-team7 (148)-L-R-r090.bmp
&#9474;&#160;&#160; &#9500;&#9472;&#9472; .............................
&#9474;&#160;&#160; &#9500;&#9472;&#9472; 0041-team7 (148)-L-R-r330.bmp
&#9474;&#160;&#160; &#9500;&#9472;&#9472; 0041-team7 (148)-shift-sx000-sy003.bmp   &#24179;&#31227;&#24038;&#21491; 0%&#65292;&#19978;&#19979; 3%
&#9474;&#160;&#160; &#9500;&#9472;&#9472; .............................
&#9474;&#160;&#160; &#9500;&#9472;&#9472; 0041-team7 (148)-shift-sx-10-sy-10.bmp
&#9474;&#160;&#160; &#9500;&#9472;&#9472; 0041-team7 (148)-U-D.bmp                 &#19978;&#19979;&#38236;&#20687;
&#9474;&#160;&#160; &#9500;&#9472;&#9472; .............................
&#9474;&#160;&#160; &#9492;&#9472;&#9472; 0041-team7 (148)-U-D-r330.bmp
&#9500;&#9472;&#9472; neg                            &#65288;&#36127;&#26679;&#26412; 602 &#24352;&#65289;
&#9474;&#160;&#160; &#9500;&#9472;&#9472; 0041-team7 (148)-rand-cx0057-cy1450-r305.bmp &#38543;&#26426;&#20013;&#24515;&#28857;&#12289;&#26059;&#36716;&#35282;&#24230;
&#9474;&#160;&#160; &#9500;&#9472;&#9472; ............................................
&#9474;&#160;&#160; &#9492;&#9472;&#9472; 0041-team7 (148)-rand-cx2393-cy2979-r299.bmp
&#9492;&#9472;&#9472; team7 (148)-demo.jpg           &#65288;&#23637;&#31034;&#20102;&#27491;&#36127;&#26679;&#26412;&#20999;&#29255;&#20301;&#32622;&#65289;

2 directories, 696 files</code></pre>
<p>&#26377;&#20102;&#27491;&#36127;&#26679;&#26412;&#65292;&#23601;&#30475;&#29992; OpenCV &#25552;&#20379;&#30340; ANN_MLP &#36827;&#34892;&#22522;&#20110;&#31070;&#32463;&#32593;&#32476;&#26041;&#27861;&#30340;&#23398;&#20064;&#12290;&#36825;&#37096;&#20998;&#30693;&#35782;&#38468;&#22312;&#26412;&#25991;&#26411;&#23614;&#12290;</p>
<p>&#20174;&#32534;&#30721;&#30340;&#35282;&#24230;&#65292;&#21033;&#29992;&#31070;&#32463;&#32593;&#32476;&#22810;&#23618;&#24863;&#30693;&#22120;&#20998;&#31867;&#30340;&#23454;&#38469;&#27604;&#22270;&#29255;&#39044;&#22788;&#29702;&#12289;&#27491;&#36127;&#26679;&#26412;&#30340;&#29983;&#25104;&#35201;&#31616;&#21333;&#65292;&#20195;&#30721;&#37327;&#20063;&#23569;&#24456;&#22810;&#12290;&#25152;&#20197;&#25105;&#20174;&#20195;&#30721;&#22823;&#27010;&#35828;&#19968;&#19979;&#20351;&#29992;&#26041;&#27861;&#12290;</p>
<p>&#39318;&#20808;&#65292;&#24341;&#20837; OpenCV3 &#30456;&#20851;&#22836;&#25991;&#20214;&#65306;</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="ot">#include &lt;opencv2/core.hpp&gt;</span>
<span class="ot">#include &lt;opencv2/ml.hpp&gt;</span></code></pre></div>
<p>&#25105;&#23553;&#35013;&#20102;&#19968;&#20010; MLP &#31867;&#65292;&#25552;&#20379;&#31616;&#21333;&#30340;&#35757;&#32451;&#25509;&#21475;&#65288;<a href="https://github.com/district10/SignProcessing/blob/qt4cv3vs2015/src/MLP/MLP.h">&#28304;&#30721;</a>&#65289;&#12290;&#36825;&#37324;&#26159;&#31934;&#31616;&#20102;&#30340;&#31867;&#22768;&#26126;&#65306;</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="kw">class</span> MLP
{
<span class="kw">public</span>:
    MLP();                                          <span class="co">// &#26500;&#36896;&#20989;&#25968;&#65292;mlp &#30340;&#21021;&#22987;&#21270;</span>
    ~MLP() { }

    <span class="dt">void</span> loadXML( <span class="dt">const</span> <span class="ot">QString</span> &amp;xml  );            <span class="co">// &#21152;&#36733;&#24050;&#32463;&#35757;&#32451;&#22909;&#30340;&#27169;&#22411;</span>
    <span class="dt">void</span> saveXML( <span class="dt">const</span> <span class="ot">QString</span> &amp;xml  );            <span class="co">// &#20445;&#23384;&#35757;&#32451;&#22909;&#30340;&#27169;&#22411;</span>
    <span class="dt">void</span> loadCSV( <span class="dt">const</span> <span class="ot">QString</span> &amp;csv );             <span class="co">// &#21152;&#36733;&#27491;&#36127;&#26679;&#26412;&#29992;&#20110;&#35757;&#32451;</span>
    <span class="dt">void</span> train();                                   <span class="co">// &#35757;&#32451;</span>

    <span class="co">// &#26368;&#21518;&#65292;&#23545;&#22270;&#29255;&#36827;&#34892;&#21028;&#21035;&#65306;&#26159;&#21542;&#20026;&#36335;&#29260;</span>
    <span class="co">//  &#36755;&#20837;&#20026;&#19968;&#20018;&#22270;&#29255;&#36335;&#24452;</span>
    <span class="co">//  &#36755;&#20986;&#20026;&#22270;&#29255;&#36335;&#24452;&#21644;&#19968;&#20010;&#26631;&#24535;&#65292;true &#35828;&#26126;&#22270;&#29255;&#20026;&#36335;&#29260;&#65292;false &#35828;&#26126;&#19981;&#26159;</span>
    <span class="ot">QList</span>&lt;<span class="ot">QPair</span>&lt;<span class="ot">QString</span>, <span class="dt">bool</span>&gt; &gt; predictImages( <span class="dt">const</span> <span class="ot">QStringList</span> &amp;images );

<span class="kw">private</span>:
    cv::Ptr&lt;cv::ml::ANN_MLP&gt; mlp;                   <span class="co">// &#23384;&#20648;&#20102;&#21442;&#25968;</span>
};</code></pre></div>
<p>&#20854;&#20013;&#22312;&#26500;&#36896;&#20989;&#25968;&#20013;&#65292;&#35201;&#23454;&#20363;&#21270; mlp&#65292;&#36824;&#35201;&#23545;&#23427;&#36827;&#34892;&#37197;&#32622;&#65306;</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp">mlp = cv::ml::ANN_MLP::create();
<span class="co">// &#23618;&#25968;&#21644;&#27599;&#23618; neuron &#20010;&#25968;&#23545;&#32467;&#26524;&#26377;&#19968;&#23450;&#24433;&#21709;&#65292;&#19979;&#25991;&#23545;&#27492;&#26377;&#35770;&#36848;</span>
mlp-&gt;setLayerSizes( (cv::Mat)(cv::Mat_&lt;<span class="dt">int</span>&gt;(<span class="dv">1</span>,<span class="dv">5</span>)
                                &lt;&lt; FEATURENUM, FEATURENUM / <span class="dv">2</span>, FEATURENUM / <span class="dv">6</span>, FEATURENUM / <span class="dv">24</span>, <span class="dv">1</span>) );

<span class="co">// &#28608;&#27963;&#20989;&#25968;&#35774;&#32622;&#20026; sigmoid</span>
mlp-&gt;setActivationFunction( cv::ml::ANN_MLP::SIGMOID_SYM, <span class="fl">1.0</span>, <span class="fl">1.0</span> );

<span class="co">// &#35757;&#32451;&#26041;&#27861;&#20026;&#21453;&#21521;&#20256;&#25773;</span>
mlp-&gt;setTrainMethod( cv::ml::ANN_MLP::BACKPROP, <span class="fl">0.1</span>, <span class="fl">0.1</span> );
mlp-&gt;setTermCriteria( cv::TermCriteria(
                            cv::TermCriteria::COUNT + cv::TermCriteria::EPS
                            , <span class="dv">5000</span>
                            , <span class="fl">0.01</span> ) );</code></pre></div>
<p>&#28608;&#27963;&#20989;&#25968;&#21644;&#21453;&#21521;&#20256;&#25773;&#30340;&#35828;&#26126;&#35265;&#26412;&#25991;&#26411;&#23614;&#38468;&#24405;&#12290;&#21453;&#21521;&#20256;&#25773;&#19968;&#20010;&#27604;&#36739;&#22909;&#30340;&#25991;&#26723;&#35265;&#25105;&#30340;&#31508;&#35760;&#65306; <a href="http://tangzx.qiniudn.com/notes/caffe-notes/backpropagation.html">Principles of training multi-layer neural network using backpropagation</a>&#12290;</p>
<p>Layer &#30340;&#23618;&#25968;&#21644;&#27599;&#23618;&#30340; neuron &#25968;&#30446;&#23545;&#35757;&#32451;&#32467;&#26524;&#26377;&#36739;&#22823;&#24433;&#21709;&#65292;&#36825;&#26159;&#25105;&#20043;&#21069;&#27979;&#35797;&#21518;&#30011;&#30340; Excel &#34920;&#26684;&#65306; <a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a></p>
<div class="figure">
<img src="http://whudoc.qiniudn.com/2016/excel-1.png" alt="CvANN::MLP &#20013;&#31070;&#32463;&#32593;&#32476;&#23618;&#25968;&#23545;&#27491;&#30830;&#29575;&#30340;&#24433;&#21709;&#65292;&#21487;&#20197;&#30475;&#21040; 5 &#23618;&#65292;&#27599;&#23618; neuron &#25968;&#38543;&#25351;&#25968;&#20989;&#25968;&#20809;&#28369;&#19979;&#38477;&#30340;&#24773;&#20917;&#19979;&#27491;&#30830;&#29575;&#26368;&#39640;&#65292;&#26377; 0.97164&#65292;&#36825;&#37324;&#30340;&#27491;&#30830;&#29575;&#26159;&#29992;&#27491;/&#36127;&#26679;&#26412;&#30340; 3/4 &#35757;&#32451;&#65292;&#21097;&#19979;&#30340; 1/4 &#26469;&#27979;&#35797;&#24471;&#21040;&#30340;&#12290;" />
<p class="caption">CvANN::MLP &#20013;&#31070;&#32463;&#32593;&#32476;&#23618;&#25968;&#23545;&#27491;&#30830;&#29575;&#30340;&#24433;&#21709;&#65292;&#21487;&#20197;&#30475;&#21040; 5 &#23618;&#65292;&#27599;&#23618; neuron &#25968;&#38543;&#25351;&#25968;&#20989;&#25968;&#20809;&#28369;&#19979;&#38477;&#30340;&#24773;&#20917;&#19979;&#27491;&#30830;&#29575;&#26368;&#39640;&#65292;&#26377; 0.97164&#65292;&#36825;&#37324;&#30340;&#27491;&#30830;&#29575;&#26159;&#29992;&#27491;/&#36127;&#26679;&#26412;&#30340; 3/4 &#35757;&#32451;&#65292;&#21097;&#19979;&#30340; 1/4 &#26469;&#27979;&#35797;&#24471;&#21040;&#30340;&#12290;</p>
</div>
<div class="figure">
<img src="http://whudoc.qiniudn.com/2016/excel-2.png" alt="CvANN::MLP &#20013; layerSizes&#65288;&#21363;&#27599;&#23618;&#20013; neuron &#30340;&#20010;&#25968;&#65289;&#23545;&#27491;&#30830;&#29575;&#30340;&#24433;&#21709;&#65292;&#21487;&#20197;&#30475;&#21040;&#25351;&#25968;&#20989;&#25968;&#23601;&#26159;&#21500;" />
<p class="caption">CvANN::MLP &#20013; layerSizes&#65288;&#21363;&#27599;&#23618;&#20013; neuron &#30340;&#20010;&#25968;&#65289;&#23545;&#27491;&#30830;&#29575;&#30340;&#24433;&#21709;&#65292;&#21487;&#20197;&#30475;&#21040;&#25351;&#25968;&#20989;&#25968;&#23601;&#26159;&#21500;</p>
</div>
<p>&#35774;&#32622;&#22909;&#20102;&#65292;&#23601;&#21487;&#20197;&#29992;&#24050;&#32463;&#20934;&#22791;&#22909;&#30340;&#27491;&#36127;&#26679;&#26412;&#35757;&#32451;&#23427;&#12290;&#25105;&#20204;&#20808;&#19981;&#32771;&#34385;&#30340;&#26159;&#22914;&#20309;&#20174; 24 &#215; 24 &#30340; RGB &#22270;&#29255;&#65292;&#29983;&#25104; feature &#21521;&#37327;&#65288;&#20063;&#23601;&#26159;&#36825;&#37324;&#30340; <code>Utils::img2feature</code> &#20989;&#25968;&#30340;&#23454;&#29616;&#32454;&#33410;&#65289;&#12290;</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="co">// pos &#21644; neg &#26159;&#22270;&#29255;&#36335;&#24452;&#21015;&#34920;&#65292;&#20998;&#21035;&#26159;&#27491;&#36127;&#26679;&#26412;&#38598;&#21512;</span>
<span class="dt">int</span> np = pos.length();
<span class="dt">int</span> nn = neg.length();

<span class="co">// &#29983;&#25104;&#25968;&#25454;&#38598;&#65292;&#36825;&#37324;&#30340; features &#21644; flags &#23601;&#26159;&#26426;&#22120;&#23398;&#20064;&#37324;</span>
<span class="co">// &#24120;&#35828;&#30340; data &#21644; label</span>
<span class="dt">float</span> *features = <span class="kw">new</span> <span class="dt">float</span>[FEATURENUM*(np + nn)];
<span class="dt">float</span> *flags    = <span class="kw">new</span> <span class="dt">float</span>[np + nn];

<span class="co">// &#29992;&#22270;&#29255;&#21021;&#22987;&#21270; features&#65292;&#24182;&#35774;&#32622;&#22909; labels</span>
<span class="kw">for</span> ( <span class="dt">int</span> i = <span class="dv">0</span>; i &lt; np; ++i ) {
    Utils::img2feature(<span class="fu">qPrintable</span>(pos.at(i)), features + FEATURENUM*i);
    *(flags + i)        =       <span class="fl">1.0f</span>;       <span class="co">// &#27491;&#26679;&#26412;&#20026; 1</span>
}
<span class="kw">for</span> ( <span class="dt">int</span> i = <span class="dv">0</span>; i &lt; nn; ++i ) {
    Utils::img2feature(<span class="fu">qPrintable</span>(neg.at(i)), features + FEATURENUM*np+FEATURENUM*i);
    *(flags + np + i)   =       <span class="fl">-1.0f</span>;      <span class="co">// &#36127;&#26679;&#26412;&#20026; -1</span>
}

<span class="co">// &#23384;&#21040; OpenCV &#30340;&#30697;&#38453;&#32467;&#26500; Mat &#37324;&#65292;&#24182;&#29983;&#25104;&#25968;&#25454;&#38598;</span>
cv::Mat featureMat( np+nn, FEATURENUM,  CV_32F, features );
cv::Mat flagMat(    np+nn, <span class="dv">1</span>,           CV_32F, flags );
cv::Ptr&lt;cv::ml::TrainData&gt; trainSet <span class="co">// mat &#30340;&#27599;&#19968;&#34892;&#20195;&#34920;&#19968;&#26465;&#25968;&#25454;</span>
    = cv::ml::TrainData::create( featureMat, cv::ml::ROW_SAMPLE, flagMat );

<span class="co">// &#28982;&#21518;&#23601;&#21487;&#20197;&#35757;&#32451;&#20102;</span>
mlp-&gt;train( trainSet );

<span class="co">// &#19981;&#35201;&#24536;&#20102;&#37322;&#25918;&#20869;&#23384;</span>
<span class="kw">delete</span>[] features;
<span class="kw">delete</span>[] flags;</code></pre></div>
<p>&#29616;&#22312;&#23601;&#33021;&#27979;&#35797;&#65292;</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="dt">float</span> feature[FEATURENUM];
Utils::img2feature( <span class="st">&quot;path/to/image&quot;</span>, feature );

cv::Mat featureMat  ( <span class="dv">1</span>, FEATURENUM,    CV_32F, feature );
cv::Mat result      ( <span class="dv">1</span>, <span class="dv">1</span>,             CV_32FC1 );

mlp-&gt;predict( featureMat, result );
<span class="dt">float</span> *p = result.ptr&lt;<span class="dt">float</span>&gt;(<span class="dv">0</span>);</code></pre></div>
<p>&#36825;&#20010; <code>*p</code> &#22823;&#20110; 0&#65292;&#21017;&#22270;&#29255;&#34987;&#21028;&#23450;&#20026;&#36335;&#29260;&#65292;&#21542;&#21017;&#19981;&#26159;&#36335;&#29260;&#12290;</p>
<p>&#25105;&#20204;&#36824;&#21487;&#20197;&#23558;&#35757;&#32451;&#22909;&#30340;&#27169;&#22411;&#20445;&#23384;&#36215;&#26469;&#65292;&#26041;&#20415;&#19979;&#36733;&#21152;&#36733;&#65306;</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="co">// &#20445;&#23384;</span>
mlp-&gt;save( <span class="st">&quot;path/to/save/model(xml file)&quot;</span> );

<span class="co">// &#21152;&#36733;</span>
mlp = cv::Algorithm::load&lt;cv::ml::ANN_MLP&gt;( <span class="st">&quot;path/to/saved-model.xml&quot;</span> );</code></pre></div>
<p>&#25105;&#35757;&#32451;&#20102;&#20960;&#32452;&#25968;&#25454;&#65292;&#24471;&#21040;&#30340; xml &#25991;&#20214;&#35265; <a href="https://github.com/district10/SignProcessing/tree/qt4cv3vs2015/data/output"><code>data/output</code></a> &#25991;&#20214;&#22841;&#12290;&#22823;&#27010;&#38271;&#36825;&#26679;&#12290;</p>
<div class="figure">
<img src="http://whudoc.qiniudn.com/2016/bp.png" />

</div>
<p>&#26368;&#21518;&#25105;&#20204;&#30475;&#30475;&#37027;&#20010; <code>Utils::img2feature</code> &#20989;&#25968;&#30340;&#23454;&#29616;&#65288;&#36825;&#37324;&#21152;&#19978;&#20102;&#39069;&#22806;&#30340;&#27880;&#37322;&#65292;&#20570;&#20102;&#39069;&#22806;&#30340;&#23545;&#40784;&#65289;&#65306;</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="co">// feature &#24050;&#32463;&#20998;&#37197;&#22909;&#20869;&#23384;&#20102;&#65292;&#20869;&#23384;&#22823;&#23567;&#26159; sizeof(float)*FEATURENUM</span>
<span class="co">// FEATURENUM &#26159;&#19968;&#20010;&#23439;&#65292;&#23450;&#20041;&#20026;</span>
<span class="co">//      #define FEATURENUM  ( 24*(3+3)+ 3 + 4*3 )</span>
<span class="co">// &#30475;&#20102;&#21518;&#38754;&#30340;&#25968;&#25454;&#22788;&#29702;&#20320;&#22823;&#27010;&#33021;&#25026;&#36825;&#20123;&#25968;&#23383;&#27599;&#20010;&#20195;&#34920;&#20160;&#20040;</span>

<span class="dt">bool</span> Utils::img2feature( <span class="dt">const</span> <span class="dt">char</span> *filePath, <span class="dt">float</span> *feature )
{
    Mat img = imread( filePath, cv::IMREAD_COLOR );
    <span class="kw">if</span> ( img.rows != IMGSIZE || img.cols != IMGSIZE ) {
        <span class="fu">qDebug</span>() &lt;&lt; __FUNCDNAME__ &lt;&lt; <span class="st">&quot;failed, because of wrong dim,&quot;</span> &lt;&lt; <span class="st">&quot;</span><span class="ch">\t</span><span class="st">filepath:&quot;</span> &lt;&lt; filePath;
        <span class="kw">return</span> <span class="kw">false</span>;
    }

    <span class="dt">int</span> allCountR          =   <span class="dv">0</span>  , allCountG          =   <span class="dv">0</span>  , allCountB          =   <span class="dv">0</span>  ;
    <span class="dt">int</span> rowCountR[IMGSIZE] = { <span class="dv">0</span> }, rowCountG[IMGSIZE] = { <span class="dv">0</span> }, rowCountB[IMGSIZE] = { <span class="dv">0</span> };
    <span class="dt">int</span> colCountR[IMGSIZE] = { <span class="dv">0</span> }, colCountG[IMGSIZE] = { <span class="dv">0</span> }, colCountB[IMGSIZE] = { <span class="dv">0</span> };
    <span class="dt">int</span> tempR[<span class="dv">4</span>]           = { <span class="dv">0</span> }, tempG[<span class="dv">4</span>]           = { <span class="dv">0</span> }, tempB[<span class="dv">4</span>]           = { <span class="dv">0</span> };

    <span class="kw">for</span>( <span class="dt">int</span> i = <span class="dv">0</span>; i &lt; IMGSIZE; ++i ) {
        <span class="kw">for</span>( <span class="dt">int</span> j = <span class="dv">0</span>; j &lt; IMGSIZE; ++j ) {

            <span class="dt">int</span> b = img.at&lt;cv::Vec3b&gt;(i,j)[<span class="dv">0</span>];
            <span class="dt">int</span> g = img.at&lt;cv::Vec3b&gt;(i,j)[<span class="dv">1</span>];
            <span class="dt">int</span> r = img.at&lt;cv::Vec3b&gt;(i,j)[<span class="dv">2</span>];

            allCountR += r;     rowCountR[i] += r;     colCountR[j] += r;
            allCountG += g;     rowCountG[i] += g;     colCountG[j] += g;
            allCountB += b;     rowCountB[i] += b;     colCountB[j] += b;

            <span class="co">/*</span>
<span class="co">             * &#20998;&#25104;&#22235;&#20010;&#37096;&#20998;&#65292;&#32479;&#35745;&#21508;&#33258;&#21306;&#22495;&#20869;&#30340; rgb &#27604;&#20363;&#65292;&#22235;&#20010;&#21306;&#22495;&#20302;&#32534;&#21495;&#20026;&#65306;</span>
<span class="co">             *</span>
<span class="co">             *           0 | 1</span>
<span class="co">             *           --+--</span>
<span class="co">             *           2 | 3</span>
<span class="co">            */</span>
            <span class="dt">int</span> index = <span class="dv">2</span> * (i &lt; IMGSIZE / <span class="dv">2</span> ? <span class="dv">0</span> : <span class="dv">1</span>) + (j &lt; IMGSIZE / <span class="dv">2</span> ? <span class="dv">0</span> : <span class="dv">1</span>);
            tempR[index] += r;
            tempG[index] += g;
            tempB[index] += b;
        }
    }

    <span class="co">// &#27599;&#34892;&#27599;&#21015; rgb</span>
    <span class="kw">for</span> ( <span class="dt">int</span> i=<span class="dv">0</span>; i &lt; IMGSIZE; ++i ) {
        feature[i*<span class="dv">6+0</span>] = (<span class="dt">float</span>)rowCountR[i]/allCountR; <span class="co">// &#31532; i &#34892;&#30340;&#32418;&#33394;&#21344;&#20840;&#22270;&#32418;&#33394;&#30340;&#27604;&#20363;</span>
        feature[i*<span class="dv">6+1</span>] = (<span class="dt">float</span>)rowCountG[i]/allCountG; <span class="co">// &#32511;&#33394;</span>
        feature[i*<span class="dv">6+2</span>] = (<span class="dt">float</span>)rowCountB[i]/allCountB; <span class="co">// &#34013;&#33394;</span>
        feature[i*<span class="dv">6+3</span>] = (<span class="dt">float</span>)colCountR[i]/allCountR; <span class="co">// &#31532; i &#21015;</span>
        feature[i*<span class="dv">6+4</span>] = (<span class="dt">float</span>)colCountG[i]/allCountG;
        feature[i*<span class="dv">6+5</span>] = (<span class="dt">float</span>)colCountB[i]/allCountB;
    }
    <span class="co">// rgb &#19977;&#31181;&#39068;&#33394;&#30340;&#27604;&#20363;</span>
    feature[IMGSIZE*<span class="dv">6+0</span>] = (<span class="dt">float</span>)allCountR / (allCountR + allCountG +allCountB);
    feature[IMGSIZE*<span class="dv">6+1</span>] = (<span class="dt">float</span>)allCountG / (allCountR + allCountG +allCountB);
    feature[IMGSIZE*<span class="dv">6+2</span>] = (<span class="dt">float</span>)allCountB / (allCountR + allCountG +allCountB);
    <span class="co">// &#22235;&#20010;&#21306;&#22495;</span>
    <span class="kw">for</span> ( <span class="dt">int</span> i = <span class="dv">0</span>; i &lt; <span class="dv">4</span>; ++i ) {
        <span class="co">// &#21306;&#22495;&#20869;&#30340; rgb &#27604;&#20363;</span>
        <span class="dt">int</span> total = tempR[i] + tempG[i] + tempB[i];
        feature[IMGSIZE*<span class="dv">6+3</span> + <span class="dv">3</span>*i<span class="dv">+0</span>] = (<span class="dt">float</span>)tempR[i] / total;
        feature[IMGSIZE*<span class="dv">6+3</span> + <span class="dv">3</span>*i<span class="dv">+1</span>] = (<span class="dt">float</span>)tempG[i] / total;
        feature[IMGSIZE*<span class="dv">6+3</span> + <span class="dv">3</span>*i<span class="dv">+2</span>] = (<span class="dt">float</span>)tempB[i] / total;
    }
    <span class="kw">return</span> <span class="kw">true</span>;
}</code></pre></div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>&#23436;&#25972;&#29256;&#21487;&#20197;&#22312; <a href="http://gnat.qiniudn.com/sc/info-all.txt" class="uri">http://gnat.qiniudn.com/sc/info-all.txt</a> &#19979;&#36733;&#12290;<a href="#fnref1">&#8617;</a></p></li>
<li id="fn2"><p>&#39034;&#20415;&#23398;&#20064;&#20102; Excel &#30340; minimap &#30340;&#29992;&#27861;&#21704;&#21704;&#12290;<a href="#fnref2">&#8617;</a></p></li>
</ol>
</div>
<ul class="tzx-tags-group">
<li><a class="tzx-tag" href="tags.html/#algorithm">algorithm</a></li>
<li><a class="tzx-tag" href="tags.html/#cv">cv</a></li>
<li><a class="tzx-tag" href="tags.html/#machine-learning">machine-learning</a></li>
</ul>

<div class="tzx-changes"><select id="tzx-changes" title="&#21382;&#21490;&#29256;&#26412;">
<option value="https://raw.githubusercontent.com/district10/blog/5a7d1f7d62a5cd8a23e9aaa6609f69393870e372/_posts/post-0072-cvann-mlp.md" title="10 insertions(+), 566 deletions(-)">1480428507</option>
<option value="https://raw.githubusercontent.com/district10/blog/b08a696f534c650b0d7fccc3b0b1d7d0d68c6d3d/_posts/post-0072-cvann-mlp.md" title="1041 insertions(+), 0 deletions(-)">1480083296</option>
</select></div>

<script>
var tzxFilename = "_posts/post-0072-cvann-mlp.md";
var tzxChanges = [
    {
        hash: "5a7d1f7d62a5cd8a23e9aaa6609f69393870e372",
        datetime: "1480428507",
        insertions: 10,
        deletions: 566
    },
    {
        hash: "b08a696f534c650b0d7fccc3b0b1d7d0d68c6d3d",
        datetime: "1480083296",
        insertions: 1041,
        deletions: 0
    },
];
</script>

<script type="text/javascript" src="jquery.min.js"></script>
<script type="text/javascript" src="jquery-ui.min.js"></script>
<script type="text/javascript" src="clappr.min.js"></script>
<script type="text/javascript" src="lazyload.min.js"></script>
<script type="text/javascript" src="egg.min.js"></script>
<script type="text/javascript" src="moment.min.js"></script>
<script type="text/javascript" src="clipboard.min.js"></script>
<script type="text/javascript" src="main.js"></script>
<hr style="color: #9ddcff;"/>
<div id="copyright">TANG ZhiXiong, 2017.  Generated by Pandoc on Travis CI. <a  href="https://github.com/district10/blog">Fork Me on GitHub.</a></div>
<div id="comments" class="comments-area">
    <div><span id="showDisqus" title="&#27426;&#36814;&#20132;&#27969;">&#12300;Load Disqus | &#21152;&#36733;&#35780;&#35770;&#12301;</span></div>
    <div id="disqus_thread"></div>
</div>
</body>
</html>
